# ----------------------------------------------------------------------------
# TMUX Plugin Manager (TPM) Setup
# ----------------------------------------------------------------------------

# Specify the TPM plugins directory
set -g @tpm_plugins_dir ~/.tmux/plugins

# Check if TPM is installed, if not, download it
if-shell '[ ! -d "~/.tmux/plugins/tpm" ]' \
  "run-shell 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm'"

# ----------------------------------------------------------------------------
# Display Settings
# ----------------------------------------------------------------------------

# Terminal settings
set -g default-terminal "screen-256color"
set -g mouse on # Enable mouse mode (tmux 2.1 and above)

# Window and Pane indexing
set -g base-index 1       # Start window numbering at 1
setw -g pane-base-index 1 # Start pane numbering at 1

# Title and renaming options
set -g set-titles on        # Set terminal title
set -g renumber-windows on  # Renumber windows when one closes
setw -g automatic-rename on # Rename windows based on active program

# Status line settings
set -g status on           # Enable status line
set -g status-position top # Position of the status line
set -g status-interval 5   # Update interval for status line
set -g status-justify left # Left-align windows in status line

# Activity monitoring
set -g monitor-activity on
set -g visual-activity on

# ----------------------------------------------------------------------------
# OneDark Theme Settings
# ----------------------------------------------------------------------------

set -g @plugin 'odedlaz/tmux-onedark-theme' # Load OneDark theme
set -g @onedark_theme 'true'                # Enable the OneDark theme

# Date and time formats with color
set -g @onedark_time_format "#[fg=brightyellow]%I:%M %p" # 12-hour time in yellow
set -g @onedark_date_format "#[fg=brightgreen]%d/%m/%Y"  # Date format in green

# Custom widgets (e.g., CPU, Memory, Disk Size, etc.)
set -g @onedark_widgets "#[fg=brightred] #(whoami) " # Display username

# ----------------------------------------------------------------------------
# Navigation and Key Bindings
# ----------------------------------------------------------------------------

# Session and window management
bind C-c new-window -c "#{pane_current_path}" # New window in current path
bind S command-prompt -p "Session name:" \
  "new-session -s '%%' -c '#{pane_current_path}'" # Create session with prompt
bind l lock-session                               # Lock session
bind M-r kill-server                              # Restart tmux

# Display session list with detailed windows
bind s choose-tree -w

# Pane management (toggle zoom and swap panes)
bind m resize-pane -Z        # Toggle pane zoom
bind -n M-Right swap-pane -D # Swap with next pane
bind -n M-Left swap-pane -U  # Swap with previous pane

# Split windows in the current directory
bind - split-window -v -c "#{pane_current_path}" # Vertical split
bind | split-window -h -c "#{pane_current_path}" # Horizontal split

# ----------------------------------------------------------------------------
# Plugins
# ----------------------------------------------------------------------------

# Core Plugins
set -g @plugin 'tmux-plugins/tpm'                   # Tmux Plugin Manager (TPM)
set -g @plugin 'tmux-plugins/tmux-sensible'         # Sensible tmux defaults
set -g @plugin 'tmux-plugins/tmux-resurrect'        # Save and restore sessions
set -g @plugin 'tmux-plugins/tmux-continuum'        # Automatic session backup
set -g @plugin 'tmux-plugins/tmux-yank'             # Copy text to system clipboard
set -g @plugin 'tmux-plugins/tmux-prefix-highlight' # Highlight prefix key usage
set -g @plugin 'tmux-plugins/tmux-pain-control'     # Enhanced pane management
set -g @plugin 'tmux-plugins/tmux-copycat'          # Enhanced search capabilities
set -g @plugin 'christoomey/vim-tmux-navigator'     # Vim-like pane navigation

# Continuum and Resurrect configuration
set -g @continuum-restore 'on'       # Automatically restore session
set -g @continuum-save-interval '15' # Backup interval (in minutes)

# Yank configuration
set -g @yank_selection 'clipboard' # Copy selection to system clipboard

# ----------------------------------------------------------------------------
# Additional Configuration
# ----------------------------------------------------------------------------

# Load local config if it exists
if-shell '[ -f ~/.tmux_local.conf ]' "source-file ~/.tmux_local.conf"

# ----------------------------------------------------------------------------
# Initialize TPM Plugins (Keep at the bottom)
# ----------------------------------------------------------------------------

run '~/.tmux/plugins/tpm/tpm'
